!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),ComponentLoader=function(){function ComponentLoader(){var components=void 0===arguments[0]?{}:arguments[0],context=void 0===arguments[1]?document:arguments[1];_classCallCheck(this,ComponentLoader),this.contextEl=context,this.initializedComponents={},this.numberOfInitializedComponents=0,this.components={},this.topics={},this.register(components)}return _createClass(ComponentLoader,[{key:"register",value:function(){var _this=this,components=void 0===arguments[0]?{}:arguments[0];Object.keys(components).forEach(function(componentName){_this.components[componentName]=components[componentName]})}},{key:"unregister",value:function(componentName){delete this.components[componentName]}},{key:"subscribe",value:function(topic,callback,context){this.topics.hasOwnProperty(topic)||(this.topics[topic]=[]),this.topics[topic].push({context:context,callback:callback})}},{key:"unsubscribe",value:function(topic,callback,context){if(!this.topics.hasOwnProperty(topic))return!1;for(var i=0,len=this.topics[topic].length;len>i;i++)if(this.topics[topic][i].callback===callback&&(!context||this.topics[topic][i].context===context))return this.topics[topic].splice(i,1),!0;return!1}},{key:"publish",value:function(topic){if(!this.topics.hasOwnProperty(topic))return!1;for(var args=new Array(arguments.length-1),i=0;i<args.length;++i)args[i]=arguments[i+1];for(var _i=0,len=this.topics[topic].length;len>_i;_i++){var subscription=this.topics[topic][_i];subscription&&subscription.callback&&subscription.callback.apply(subscription.context,args)}return!0}},{key:"scan",value:function(){var _this2=this,data=void 0===arguments[0]?{}:arguments[0],activeComponents={},elements=this.contextEl.querySelectorAll("[data-component]");[].forEach.call(elements,function(el){_this2._scanElement(el,activeComponents,data)}),this.numberOfInitializedComponents>0&&this.cleanUp_(activeComponents)}},{key:"_scanElement",value:function(el,activeComponents,data){var _this3=this,elementId=el.getAttribute("data-component-id");elementId||(elementId=this._generateUUID(),el.setAttribute("data-component-id",elementId));var componentList=el.getAttribute("data-component").match(/\S+/g);componentList.forEach(function(componentName){var componentId=componentName+"-"+elementId;activeComponents[componentId]=!0,_this3.initializedComponents[componentId]||_this3._initializeComponent(componentName,componentId,el,data)})}},{key:"_initializeComponent",value:function(componentName,componentId,el,data){var component=this.components[componentName];if("function"!=typeof component)throw"ComponentLoader: unknown component '"+componentName+"'";var instance=new component(el,data,this);this.initializedComponents[componentId]=instance,this.numberOfInitializedComponents++}},{key:"_destroyComponent",value:function(componentId){var instance=this.initializedComponents[componentId];instance&&"function"==typeof instance.destroy&&instance.destroy(),delete this.initializedComponents[componentId],this.numberOfInitializedComponents--}},{key:"cleanUp_",value:function(){var _this4=this,activeComponents=void 0===arguments[0]?{}:arguments[0];Object.keys(this.initializedComponents).forEach(function(componentId){activeComponents[componentId]||_this4._destroyComponent(componentId)})}},{key:"_generateUUID",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=16*Math.random()|0,v="x"==c?r:3&r|8;return v.toString(16)})}}]),ComponentLoader}();"undefined"!=typeof define&&define.amd?define([],ComponentLoader):"undefined"!=typeof module&&module.exports?module.exports=ComponentLoader:window.ComponentLoader=ComponentLoader},{}],2:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Component=function(){function Component(){_classCallCheck(this,Component),this.el=arguments[0],"undefined"!=typeof jQuery&&(this.$el=jQuery(this.el)),this.data=arguments[1],this.__mediator=arguments[2]}return _createClass(Component,[{key:"publish",value:function(){var _mediator;(_mediator=this.__mediator).publish.apply(_mediator,arguments)}},{key:"subscribe",value:function(topic,callback){this.__mediator.subscribe(topic,callback,this)}},{key:"unsubscribe",value:function(topic,callback){this.__mediator.unsubscribe(topic,callback,this)}},{key:"scan",value:function(data){this.__mediator.scan(data)}},{key:"defer",value:function(callback){var ms=void 0===arguments[1]?17:arguments[1];setTimeout(callback,ms)}},{key:"destroy",value:function(){}}]),Component}();"undefined"!=typeof define&&define.amd?define([],Component):"undefined"!=typeof module&&module.exports?module.exports=Component:window.Component=Component},{}],3:[function(require,module,exports){!function(factory){"undefined"!=typeof define&&define.amd?define([],factory):"undefined"!=typeof module&&module.exports?module.exports=factory():window.scrollMonitor=factory()}(function(){function calculateViewport(){if(exports.viewportTop=scrollTop(),exports.viewportBottom=exports.viewportTop+exports.viewportHeight,exports.documentHeight=getDocumentHeight(),exports.documentHeight!==previousDocumentHeight){for(calculateViewportI=watchers.length;calculateViewportI--;)watchers[calculateViewportI].recalculateLocation();previousDocumentHeight=exports.documentHeight}}function recalculateWatchLocationsAndTrigger(){exports.viewportHeight=getViewportHeight(),calculateViewport(),updateAndTriggerWatchers()}function debouncedRecalcuateAndTrigger(){clearTimeout(recalculateAndTriggerTimer),recalculateAndTriggerTimer=setTimeout(recalculateWatchLocationsAndTrigger,100)}function updateAndTriggerWatchers(){for(updateAndTriggerWatchersI=watchers.length;updateAndTriggerWatchersI--;)watchers[updateAndTriggerWatchersI].update();for(updateAndTriggerWatchersI=watchers.length;updateAndTriggerWatchersI--;)watchers[updateAndTriggerWatchersI].triggerCallbacks()}function ElementWatcher(watchItem,offsets){function triggerCallbackArray(listeners){if(0!==listeners.length)for(listenerToTriggerListI=listeners.length;listenerToTriggerListI--;)listener=listeners[listenerToTriggerListI],listener.callback.call(self,latestEvent),listener.isOne&&listeners.splice(listenerToTriggerListI,1)}var self=this;this.watchItem=watchItem,offsets?offsets===+offsets?this.offsets={top:offsets,bottom:offsets}:this.offsets={top:offsets.top||defaultOffsets.top,bottom:offsets.bottom||defaultOffsets.bottom}:this.offsets=defaultOffsets,this.callbacks={};for(var i=0,j=eventTypes.length;j>i;i++)self.callbacks[eventTypes[i]]=[];this.locked=!1;var wasInViewport,wasFullyInViewport,wasAboveViewport,wasBelowViewport,listenerToTriggerListI,listener;this.triggerCallbacks=function(){switch(this.isInViewport&&!wasInViewport&&triggerCallbackArray(this.callbacks[ENTERVIEWPORT]),this.isFullyInViewport&&!wasFullyInViewport&&triggerCallbackArray(this.callbacks[FULLYENTERVIEWPORT]),this.isAboveViewport!==wasAboveViewport&&this.isBelowViewport!==wasBelowViewport&&(triggerCallbackArray(this.callbacks[VISIBILITYCHANGE]),wasFullyInViewport||this.isFullyInViewport||(triggerCallbackArray(this.callbacks[FULLYENTERVIEWPORT]),triggerCallbackArray(this.callbacks[PARTIALLYEXITVIEWPORT])),wasInViewport||this.isInViewport||(triggerCallbackArray(this.callbacks[ENTERVIEWPORT]),triggerCallbackArray(this.callbacks[EXITVIEWPORT]))),!this.isFullyInViewport&&wasFullyInViewport&&triggerCallbackArray(this.callbacks[PARTIALLYEXITVIEWPORT]),!this.isInViewport&&wasInViewport&&triggerCallbackArray(this.callbacks[EXITVIEWPORT]),this.isInViewport!==wasInViewport&&triggerCallbackArray(this.callbacks[VISIBILITYCHANGE]),!0){case wasInViewport!==this.isInViewport:case wasFullyInViewport!==this.isFullyInViewport:case wasAboveViewport!==this.isAboveViewport:case wasBelowViewport!==this.isBelowViewport:triggerCallbackArray(this.callbacks[STATECHANGE])}wasInViewport=this.isInViewport,wasFullyInViewport=this.isFullyInViewport,wasAboveViewport=this.isAboveViewport,wasBelowViewport=this.isBelowViewport},this.recalculateLocation=function(){if(!this.locked){var previousTop=this.top,previousBottom=this.bottom;if(this.watchItem.nodeName){var cachedDisplay=this.watchItem.style.display;"none"===cachedDisplay&&(this.watchItem.style.display="");var boundingRect=this.watchItem.getBoundingClientRect();this.top=boundingRect.top+exports.viewportTop,this.bottom=boundingRect.bottom+exports.viewportTop,"none"===cachedDisplay&&(this.watchItem.style.display=cachedDisplay)}else this.watchItem===+this.watchItem?this.watchItem>0?this.top=this.bottom=this.watchItem:this.top=this.bottom=exports.documentHeight-this.watchItem:(this.top=this.watchItem.top,this.bottom=this.watchItem.bottom);this.top-=this.offsets.top,this.bottom+=this.offsets.bottom,this.height=this.bottom-this.top,void 0===previousTop&&void 0===previousBottom||this.top===previousTop&&this.bottom===previousBottom||triggerCallbackArray(this.callbacks[LOCATIONCHANGE])}},this.recalculateLocation(),this.update(),wasInViewport=this.isInViewport,wasFullyInViewport=this.isFullyInViewport,wasAboveViewport=this.isAboveViewport,wasBelowViewport=this.isBelowViewport}function scrollMonitorListener(event){latestEvent=event,calculateViewport(),updateAndTriggerWatchers()}var scrollTop=function(){return window.pageYOffset||document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop},exports={},watchers=[],VISIBILITYCHANGE="visibilityChange",ENTERVIEWPORT="enterViewport",FULLYENTERVIEWPORT="fullyEnterViewport",EXITVIEWPORT="exitViewport",PARTIALLYEXITVIEWPORT="partiallyExitViewport",LOCATIONCHANGE="locationChange",STATECHANGE="stateChange",eventTypes=[VISIBILITYCHANGE,ENTERVIEWPORT,FULLYENTERVIEWPORT,EXITVIEWPORT,PARTIALLYEXITVIEWPORT,LOCATIONCHANGE,STATECHANGE],defaultOffsets={top:0,bottom:0},getViewportHeight=function(){return window.innerHeight||document.documentElement.clientHeight},getDocumentHeight=function(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight)};exports.viewportTop=null,exports.viewportBottom=null,exports.documentHeight=null,exports.viewportHeight=getViewportHeight();var previousDocumentHeight,latestEvent,calculateViewportI,recalculateAndTriggerTimer,updateAndTriggerWatchersI;ElementWatcher.prototype={on:function(event,callback,isOne){switch(!0){case event===VISIBILITYCHANGE&&!this.isInViewport&&this.isAboveViewport:case event===ENTERVIEWPORT&&this.isInViewport:case event===FULLYENTERVIEWPORT&&this.isFullyInViewport:case event===EXITVIEWPORT&&this.isAboveViewport&&!this.isInViewport:case event===PARTIALLYEXITVIEWPORT&&this.isAboveViewport:if(callback.call(this,latestEvent),isOne)return}if(!this.callbacks[event])throw new Error("Tried to add a scroll monitor listener of type "+event+". Your options are: "+eventTypes.join(", "));this.callbacks[event].push({callback:callback,isOne:isOne||!1})},off:function(event,callback){if(!this.callbacks[event])throw new Error("Tried to remove a scroll monitor listener of type "+event+". Your options are: "+eventTypes.join(", "));for(var item,i=0;item=this.callbacks[event][i];i++)if(item.callback===callback){this.callbacks[event].splice(i,1);break}},one:function(event,callback){this.on(event,callback,!0)},recalculateSize:function(){this.height=this.watchItem.offsetHeight+this.offsets.top+this.offsets.bottom,this.bottom=this.top+this.height},update:function(){this.isAboveViewport=this.top<exports.viewportTop,this.isBelowViewport=this.bottom>exports.viewportBottom,this.isInViewport=this.top<=exports.viewportBottom&&this.bottom>=exports.viewportTop,this.isFullyInViewport=this.top>=exports.viewportTop&&this.bottom<=exports.viewportBottom||this.isAboveViewport&&this.isBelowViewport},destroy:function(){var index=watchers.indexOf(this),self=this;watchers.splice(index,1);for(var i=0,j=eventTypes.length;j>i;i++)self.callbacks[eventTypes[i]].length=0},lock:function(){this.locked=!0},unlock:function(){this.locked=!1}};for(var eventHandlerFactory=function(type){return function(callback,isOne){this.on.call(this,type,callback,isOne)}},i=0,j=eventTypes.length;j>i;i++){var type=eventTypes[i];ElementWatcher.prototype[type]=eventHandlerFactory(type)}try{calculateViewport()}catch(e){try{window.$(calculateViewport)}catch(e){throw new Error("If you must put scrollMonitor in the <head>, you must use jQuery.")}}return window.addEventListener?(window.addEventListener("scroll",scrollMonitorListener),window.addEventListener("resize",debouncedRecalcuateAndTrigger)):(window.attachEvent("onscroll",scrollMonitorListener),window.attachEvent("onresize",debouncedRecalcuateAndTrigger)),exports.beget=exports.create=function(element,offsets){"string"==typeof element?element=document.querySelector(element):element&&element.length>0&&(element=element[0]);var watcher=new ElementWatcher(element,offsets);return watchers.push(watcher),watcher.update(),watcher},exports.update=function(){latestEvent=null,calculateViewport(),updateAndTriggerWatchers()},exports.recalculateLocations=function(){exports.documentHeight=0,exports.update()},exports})},{}],4:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);return null===parent?void 0:get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;if(void 0!==getter)return getter.call(receiver)},_component=require("component-loader-js/dist/es5/component"),_component2=_interopRequireDefault(_component),Doki=function(_Component){function Doki(){_classCallCheck(this,Doki);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(Doki).apply(this,arguments));return console.log("new DOKI 40"),_this}return _inherits(Doki,_Component),_createClass(Doki,[{key:"destroy",value:function(){_get(Object.getPrototypeOf(Doki.prototype),"destroy",this).call(this),console.log("destroy DOKI")}}]),Doki}(_component2["default"]);exports["default"]=Doki},{"component-loader-js/dist/es5/component":2}],5:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_component=require("component-loader-js/dist/es5/component"),_component2=_interopRequireDefault(_component),_animationEndEvent=require("../utils/animation-end-event"),_animationEndEvent2=_interopRequireDefault(_animationEndEvent),_scrollState=require("../utils/scroll-state"),_scrollState2=_interopRequireDefault(_scrollState),CLASS_HIDDEN="StickyNav--hidden",CLASS_VISIBLE="StickyNav--visible",CLASS_LOCKED="StickyNav--locked",CLASS_BACKGROUND="StickyNav--background",LOCK_THRESHOLD=100,MIN_SCROLL_SPEED=500,MIN_SCROLL_DISTANCE=20,StickyNav=function(_Component){function StickyNav(){_classCallCheck(this,StickyNav);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(StickyNav).apply(this,arguments));return console.log("STICKY"),_this.$document=$(document),_this.isHidden=!1,_this.isLocked=!1,_this.hasBackground=!1,_this.isBusyChecking=!1,_this.onStateChanged=_this.onStateChanged.bind(_this),_this.checkLockThreashold=_this.checkLockThreashold.bind(_this),_this.checkAppearance=_this.checkAppearance.bind(_this),_this.init(),_this.defer(function(){_this.$el.css("visibility","visible")}),_this}return _inherits(StickyNav,_Component),_createClass(StickyNav,[{key:"init",value:function(){_scrollState2["default"].subscribe(_scrollState2["default"].EVENT_SCROLL_FRAME,this.onStateChanged)}},{key:"onStateChanged",value:function(state){this.isBusyChecking||(this.isBusyChecking=!0,this.checkLockThreashold(state),this.checkBackgroundThreashold(state),this.checkAppearance(state),this.isBusyChecking=!1)}},{key:"_getBackgroundThreshold",value:function(){return LOCK_THRESHOLD+1}},{key:"show",value:function(){var _this2=this;this.isHidden&&(this.$el.addClass(CLASS_VISIBLE).removeClass(CLASS_HIDDEN),this.isHidden=!1,this.$el.one(_animationEndEvent2["default"],function(){_this2.$el.removeClass(CLASS_VISIBLE)}))}},{key:"hide",value:function(){this.isHidden||(this.$el.addClass(CLASS_HIDDEN).removeClass(CLASS_VISIBLE),this.isHidden=!0)}},{key:"lock",value:function(){this.isLocked||(this.$el.addClass(CLASS_LOCKED),this.isLocked=!0)}},{key:"unlock",value:function(){this.isLocked&&(this.$el.removeClass(CLASS_LOCKED),this.isLocked=!1)}},{key:"addBackground",value:function(){this.hasBackground||(this.$el.addClass(CLASS_BACKGROUND),this.hasBackground=!0)}},{key:"removeBackground",value:function(){this.hasBackground&&(this.$el.removeClass(CLASS_BACKGROUND),this.hasBackground=!1)}},{key:"isAboveVisibleThreshold",value:function(state){return state.viewportTop<=LOCK_THRESHOLD}},{key:"checkLockThreashold",value:function(state){state.viewportTop>=LOCK_THRESHOLD?this.lock():this.unlock()}},{key:"checkBackgroundThreashold",value:function(state){state.viewportTop>=this._getBackgroundThreshold()?this.addBackground():this.removeBackground()}},{key:"checkAppearance",value:function(state){this.isAboveVisibleThreshold(state)||state.isScrolledToBottom?this.show():state.isScrollingDown?this.hide():(state.scrollSpeed>MIN_SCROLL_SPEED||state.scrollDistance>MIN_SCROLL_DISTANCE)&&this.show()}},{key:"destroy",value:function(){this.show(),_scrollState2["default"].unsubscribe(_scrollState2["default"].EVENT_SCROLL_FRAME,this.onStateChanged)}}]),StickyNav}(_component2["default"]);module.exports=StickyNav},{"../utils/animation-end-event":7,"../utils/scroll-state":9,"component-loader-js/dist/es5/component":2}],6:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _componentLoader=require("component-loader-js/dist/es5/component-loader"),_componentLoader2=_interopRequireDefault(_componentLoader),_doki=require("./components/doki"),_doki2=_interopRequireDefault(_doki),_stickyNav=require("./components/sticky-nav"),_stickyNav2=_interopRequireDefault(_stickyNav);new _componentLoader2["default"]({Doki:_doki2["default"],StickyNav:_stickyNav2["default"]}).scan()},{"./components/doki":4,"./components/sticky-nav":5,"component-loader-js/dist/es5/component-loader":1}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=function(){var eventName=void 0,el=document.createElement("div"),animationNames={WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",OAnimation:"oAnimationEnd oanimationend",animation:"animationend"};return Object.keys(animationNames).forEach(function(t){void 0!==el.style[t]&&(eventName=animationNames[t])}),eventName}()},{}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _arguments=arguments;exports["default"]=function(func,threshold,execAsap){var timeout=void 0;return function(){var obj=void 0,args=_arguments,delayed=function(){execAsap||func.apply(obj,args),timeout=null};timeout?clearTimeout(timeout):execAsap&&func.apply(obj,args),timeout=setTimeout(delayed,threshold||100)}}},{}],9:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_debounce=require("./debounce"),_debounce2=_interopRequireDefault(_debounce),_scrollMonitor=require("scrollMonitor"),_scrollMonitor2=_interopRequireDefault(_scrollMonitor),$window=($(document),$(window)),ScrollState=function(){function ScrollState(){_classCallCheck(this,ScrollState),this.EVENT_SCROLL_START="scrollstate:start",this.EVENT_SCROLL_STOP="scrollstate:stop",this.EVENT_SCROLL_FRAME="scrollstate:frame",this.updating=!1,this.latestFrame=Date.now(),this.scrollDiff=0,this.scrollDistance=0,this.scrollDirection=0,this.msSinceLatestChange=0,this.scrollSpeed=0,this.documentHeight=void 0,this.viewportHeight=void 0,this.viewportTop=0,this.viewportBottom=void 0,this.isScrollingUp=void 0,this.isScrollingDown=void 0,this.isScrolledToTop=void 0,this.isScrolledToBottom=void 0,this.callbacks={},this.updateState(),this.onScrollStartDebounced=(0,_debounce2["default"])(this._onScrollStart.bind(this),500,!0),this.onScrollStopDebounced=(0,_debounce2["default"])(this._onScrollStop.bind(this),500),this._addEventListeners()}return _createClass(ScrollState,[{key:"subscribe",value:function(event,callback,context){this.callbacks.hasOwnProperty(event)||(this.callbacks[event]=[]),this.callbacks[event].push({context:context,callback:callback})}},{key:"unsubscribe",value:function(event,callback){if(!this.callbacks.hasOwnProperty(event))return!1;for(var i=0,len=this.callbacks[event].length;len>i;i++)if(this.callbacks[event][i].callback===callback)return this.callbacks[event].splice(i,1),!0;return!1}},{key:"_publish",value:function(event){if(!this.callbacks.hasOwnProperty(event))return!1;for(var args=new Array(arguments.length-1),i=0;i<args.length;++i)args[i]=arguments[i+1];for(var _i=0,len=this.callbacks[event].length;len>_i;_i++){var subscription=this.callbacks[event][_i];subscription.callback&&subscription.callback.apply(subscription.context,args)}return!0}},{key:"destroy",value:function(){this._removeEventListeners()}},{key:"_addEventListeners",value:function(){$window.on("scroll",this.onScrollStartDebounced),$window.on("scroll",this.onScrollStopDebounced),$window.on("scroll",this.updateState.bind(this))}},{key:"_removeEventListeners",value:function(){$window.off("scroll",this.onScrollStartDebounced),$window.off("scroll",this.onScrollStopDebounced),$window.off("scroll",this.updateState.unbind(this))}},{key:"_onScrollStart",value:function(){this._publish(this.EVENT_SCROLL_START,this)}},{key:"_onScrollStop",value:function(){this._publish(this.EVENT_SCROLL_STOP,this)}},{key:"updateState",value:function(){if(!this.updating){this.updating=!0;var now=Date.now();this.scrollDiff=this.viewportTop-_scrollMonitor2["default"].viewportTop,this.scrollDistance=Math.abs(this.scrollDiff),this.scrollDirection=Math.max(-1,Math.min(1,this.scrollDiff)),this.msSinceLatestChange=now-this.latestFrame,this.scrollSpeed=this.scrollDistance/this.msSinceLatestChange*1e3,this.documentHeight=_scrollMonitor2["default"].documentHeight,this.viewportHeight=_scrollMonitor2["default"].viewportHeight,this.viewportTop=_scrollMonitor2["default"].viewportTop,this.viewportBottom=_scrollMonitor2["default"].viewportBottom,this.isScrollingUp=this.scrollDirection>0,this.isScrollingDown=this.scrollDirection<0,this.isScrolledToTop=this.viewportTop<=0,this.isScrolledToBottom=this.viewportBottom>=this.documentHeight,this.latestFrame=now,this._publish(this.EVENT_SCROLL_FRAME,this),this.updating=!1}}}]),ScrollState}();module.exports=new ScrollState},{"./debounce":8,scrollMonitor:3}]},{},[6]);